{"ast":null,"code":"import { submitterFactory } from './submitter';\n/**\n * Converts `impressionCounts` data from cache into request payload.\n */\nexport function fromImpressionCountsCollector(impressionsCount) {\n  var pf = [];\n  var keys = Object.keys(impressionsCount);\n  for (var i = 0; i < keys.length; i++) {\n    var splitted = keys[i].split('::');\n    if (splitted.length !== 2) continue;\n    var featureName = splitted[0];\n    var timeFrame = splitted[1];\n    var impressionsInTimeframe = {\n      f: featureName,\n      m: Number(timeFrame),\n      rc: impressionsCount[keys[i]] // Count\n    };\n\n    pf.push(impressionsInTimeframe);\n  }\n  return {\n    pf: pf\n  };\n}\nvar IMPRESSIONS_COUNT_RATE = 1800000; // 30 minutes\n/**\n * Submitter that periodically posts impression counts\n */\nexport function impressionCountsSubmitterFactory(params) {\n  var log = params.settings.log,\n    postTestImpressionsCount = params.splitApi.postTestImpressionsCount,\n    impressionCounts = params.storage.impressionCounts;\n  if (impressionCounts) {\n    // retry impressions counts only once.\n    return submitterFactory(log, postTestImpressionsCount, impressionCounts, IMPRESSIONS_COUNT_RATE, 'impression counts', fromImpressionCountsCollector, 1);\n  }\n}","map":{"version":3,"names":["submitterFactory","fromImpressionCountsCollector","impressionsCount","pf","keys","Object","i","length","splitted","split","featureName","timeFrame","impressionsInTimeframe","f","m","Number","rc","push","IMPRESSIONS_COUNT_RATE","impressionCountsSubmitterFactory","params","log","settings","postTestImpressionsCount","splitApi","impressionCounts","storage"],"sources":["/Users/temitopeogunrekun/Desktop/angular-db/node_modules/@splitsoftware/splitio-commons/esm/sync/submitters/impressionCountsSubmitter.js"],"sourcesContent":["import { submitterFactory } from './submitter';\n/**\n * Converts `impressionCounts` data from cache into request payload.\n */\nexport function fromImpressionCountsCollector(impressionsCount) {\n    var pf = [];\n    var keys = Object.keys(impressionsCount);\n    for (var i = 0; i < keys.length; i++) {\n        var splitted = keys[i].split('::');\n        if (splitted.length !== 2)\n            continue;\n        var featureName = splitted[0];\n        var timeFrame = splitted[1];\n        var impressionsInTimeframe = {\n            f: featureName,\n            m: Number(timeFrame),\n            rc: impressionsCount[keys[i]] // Count\n        };\n        pf.push(impressionsInTimeframe);\n    }\n    return { pf: pf };\n}\nvar IMPRESSIONS_COUNT_RATE = 1800000; // 30 minutes\n/**\n * Submitter that periodically posts impression counts\n */\nexport function impressionCountsSubmitterFactory(params) {\n    var log = params.settings.log, postTestImpressionsCount = params.splitApi.postTestImpressionsCount, impressionCounts = params.storage.impressionCounts;\n    if (impressionCounts) {\n        // retry impressions counts only once.\n        return submitterFactory(log, postTestImpressionsCount, impressionCounts, IMPRESSIONS_COUNT_RATE, 'impression counts', fromImpressionCountsCollector, 1);\n    }\n}\n"],"mappings":"AAAA,SAASA,gBAAgB,QAAQ,aAAa;AAC9C;AACA;AACA;AACA,OAAO,SAASC,6BAA6B,CAACC,gBAAgB,EAAE;EAC5D,IAAIC,EAAE,GAAG,EAAE;EACX,IAAIC,IAAI,GAAGC,MAAM,CAACD,IAAI,CAACF,gBAAgB,CAAC;EACxC,KAAK,IAAII,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAGF,IAAI,CAACG,MAAM,EAAED,CAAC,EAAE,EAAE;IAClC,IAAIE,QAAQ,GAAGJ,IAAI,CAACE,CAAC,CAAC,CAACG,KAAK,CAAC,IAAI,CAAC;IAClC,IAAID,QAAQ,CAACD,MAAM,KAAK,CAAC,EACrB;IACJ,IAAIG,WAAW,GAAGF,QAAQ,CAAC,CAAC,CAAC;IAC7B,IAAIG,SAAS,GAAGH,QAAQ,CAAC,CAAC,CAAC;IAC3B,IAAII,sBAAsB,GAAG;MACzBC,CAAC,EAAEH,WAAW;MACdI,CAAC,EAAEC,MAAM,CAACJ,SAAS,CAAC;MACpBK,EAAE,EAAEd,gBAAgB,CAACE,IAAI,CAACE,CAAC,CAAC,CAAC,CAAC;IAClC,CAAC;;IACDH,EAAE,CAACc,IAAI,CAACL,sBAAsB,CAAC;EACnC;EACA,OAAO;IAAET,EAAE,EAAEA;EAAG,CAAC;AACrB;AACA,IAAIe,sBAAsB,GAAG,OAAO,CAAC,CAAC;AACtC;AACA;AACA;AACA,OAAO,SAASC,gCAAgC,CAACC,MAAM,EAAE;EACrD,IAAIC,GAAG,GAAGD,MAAM,CAACE,QAAQ,CAACD,GAAG;IAAEE,wBAAwB,GAAGH,MAAM,CAACI,QAAQ,CAACD,wBAAwB;IAAEE,gBAAgB,GAAGL,MAAM,CAACM,OAAO,CAACD,gBAAgB;EACtJ,IAAIA,gBAAgB,EAAE;IAClB;IACA,OAAOzB,gBAAgB,CAACqB,GAAG,EAAEE,wBAAwB,EAAEE,gBAAgB,EAAEP,sBAAsB,EAAE,mBAAmB,EAAEjB,6BAA6B,EAAE,CAAC,CAAC;EAC3J;AACJ"},"metadata":{},"sourceType":"module"}